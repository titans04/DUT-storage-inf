{% extends "base.html" %}

{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="display-4">
            {% if current_user.is_super_admin %}
                Super Admin Dashboard ðŸ‘‘
            {% else %}
                Admin Dashboard
            {% endif %}
        </h1>
        <small class="text-muted">Welcome, {{ current_user.name or current_user.username }}!</small>
    </div>

    {# --- Key Metrics / Summary Section --- #}
    <div class="row mb-5">
        <div class="col-md-4">
            <div class="card text-white bg-primary mb-3 shadow">
                <div class="card-body">
                    <h5 class="card-title">Data Capturers</h5>
                    <p class="card-text display-4">{{ total_capturers }}</p> 
                    <a href="{{ url_for('admin.manage_capturers') }}" class="text-white">Manage Capturers &rarr;</a>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-white bg-success mb-3 shadow">
                <div class="card-body">
                    <h5 class="card-title">Active Campuses</h5>
                    <p class="card-text display-4">{{ total_campuses }}</p> 
                    <a href="{{ url_for('admin.manage_campuses') }}" class="text-white">Manage Campuses &rarr;</a>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-white bg-warning mb-3 shadow">
                <div class="card-body">
                    <h5 class="card-title">Total Inventory Items</h5>
                    <p class="card-text display-4">{{ total_items }}</p> 
                    <a href="{{ url_for('admin.view_inventory') }}" class="text-white">View Inventory &rarr;</a>
                </div>
            </div>
        </div>
    </div>

    <hr>
    
    {# --- SUPER ADMIN QUICK ACTIONS (Visible only to Super Admins) --- #}
    {% if current_user.is_super_admin %}
        <h2 class="h4 mb-3 text-danger">System Administration (Super Admin Only)</h2>
        <div class="list-group mb-5">
            <a href="{{ url_for('admin.manage_admins') }}" class="list-group-item list-group-item-action list-group-item-danger">
                <i class="fas fa-user-shield mr-2"></i> Manage Other Admins (Create/Delete)
            </a>
            <a href="{{ url_for('admin.system_settings') }}" class="list-group-item list-group-item-action list-group-item-danger">
                <i class="fas fa-cog mr-2"></i> Configure System Settings
            </a>
        </div>
        <hr>
    {% endif %}

    {# --- General Admin Quick Actions --- #}
    <h2 class="h4 mb-3">General Management Actions</h2>
    <div class="list-group">
        <a href="{{ url_for('admin.add_capturer') }}" class="list-group-item list-group-item-action">
            <i class="fas fa-user-plus mr-2"></i> Register New Data Capturer
        </a>
        
        {# --- CRITICAL FIX APPLIED: 'Add Campus' is now conditional on is_super_admin --- #}
        {% if current_user.is_super_admin %}
        <a href="{{ url_for('admin.add_campus') }}" class="list-group-item list-group-item-action">
            <i class="fas fa-building mr-2"></i> Add a New Campus Location
        </a>
        {% endif %}
        {# -------------------------------------------------------------------------------- #}
        
        <a href="{{ url_for('admin.run_report') }}" class="list-group-item list-group-item-action">
            <i class="fas fa-file-export mr-2"></i> Generate Inventory Report
        </a>
    </div>

</div>
{% endblock %}